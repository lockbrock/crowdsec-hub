filter: 1 == 1
debug: true
onsuccess: next_stage
name: crowdsecurity/authentik-logs
description: "Parse Authentik Logs"
pattern_syntax:
  AUTHENTIK_BAD_LOGIN: 'client_ip": "%{IPORHOST:source_ip}".*"username": "%{DATA:username}".*"host": "%{DATA:url}".*"timestamp": "%{DATA:timestamp}"'
nodes:
 - grok:
     name: "AUTHENTIK_BAD_LOGIN"
     apply_on: message
     statics:
       - meta: log_type
         value: authentik_failed_auth
       - meta: log_subtype
         value: authentik_failed_login
statics:
    - meta: service
      value: authentik
